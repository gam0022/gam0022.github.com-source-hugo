<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>gam0022.net</title>
    <link>https://gam0022.net/tags/serversmanvps/index.xml</link>
    <description>Recent content on gam0022.net</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>jp</language>
    <copyright>&amp;copy; 2016 gam0022</copyright>
    <atom:link href="/tags/serversmanvps/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>ServersMan@VPSã‹ã‚‰ConoHaã«å¼•ã£è¶Šã—ã¾ã—ãŸ</title>
      <link>https://gam0022.net/blog/2017/11/14/move-from-serversman-to-conoha/</link>
      <pubDate>Tue, 14 Nov 2017 01:00:00 +0900</pubDate>
      
      <guid>https://gam0022.net/blog/2017/11/14/move-from-serversman-to-conoha/</guid>
      <description>&lt;p&gt;å½“ã‚µã‚¤ãƒˆï¼ˆ&lt;a href=&#34;https://gam0022.net/&#34;&gt;gam0022.net&lt;/a&gt;ï¼‰ã‚’å‹•ã‹ã—ã¦ã„ã‚‹ã‚µãƒ¼ãƒã‚’&lt;a href=&#34;http://dream.jp/vps/&#34;&gt;ServersMan@VPS&lt;/a&gt;ã‹ã‚‰&lt;a href=&#34;https://www.conoha.jp/&#34;&gt;ConoHa&lt;/a&gt;ã«ä¹—ã‚Šæ›ãˆã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;2011/12ã«ServersMan@VPSã‚’å¥‘ç´„ã—ãŸã®ã§ã€ãªã‚“ã¨6å¹´é–“ã‚‚ãŠä¸–è©±ã«ãªã‚Šã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;ServersManã•ã‚“é•·ã„é–“ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚ConoHaã¡ã‚ƒã‚“ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;h1 id=&#34;å¼•ã£è¶Šã—ãŸç†ç”±&#34;&gt;å¼•ã£è¶Šã—ãŸç†ç”±&lt;/h1&gt;

&lt;p&gt;çµè«–ã‹ã‚‰è¨€ã†ã¨ã€ServersMan@VPSã§è¨­å®šã•ã‚Œã¦ã„ã‚‹TCPã®ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºåˆ¶é™ãŒå³ã—ã™ãã¦ã€ãƒ–ãƒ­ã‚°ç”¨ã®ã‚µãƒ¼ãƒã¨ã—ã¦ã®åˆ©ç”¨ãŒå›°é›£ã«ãªã£ã¦ããŸã‹ã‚‰ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;å»å¹´é ƒã‹ã‚‰è¨˜äº‹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒå¢—ãˆã‚‹ã¨ã€ã‚¢ã‚¯ã‚»ã‚¹ãŒéå¸¸ã«é…ããªã£ãŸã‚Šã€ã‚µãƒ¼ãƒãŒå¼·åˆ¶åœæ­¢ã—ã¦sshã™ã‚‰ã§ããªã„çŠ¶æ³ãŒé »ç™ºã—ã¦ã„ã¾ã—ãŸã€‚
ç‰¹ã«ã‚µãƒ¼ãƒãŒåœæ­¢ã•ã‚Œã‚‹ã¨ç®¡ç†ç”»é¢ã‹ã‚‰ã‚µãƒ¼ãƒã‚’å†èµ·å‹•ã™ã‚‹ã—ã‹ãªããªã‚Šã€éå¸¸ã«å›°ã£ã¦ã„ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;ServersMan@VPSã§ã¯OpenVZã¨ã„ã†ã‚µãƒ¼ãƒä»®æƒ³åŒ–ã‚½ãƒ•ãƒˆãŒä½¿ã‚ã‚Œã¦ã„ã¾ã™ã€‚
OpneVZã®ãƒªã‚½ãƒ¼ã‚¹æƒ…å ±ã¯ &lt;code&gt;/proc/user_beancounters&lt;/code&gt; ã‹ã‚‰ç¢ºèªã§ãã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cat /proc/user_beancounters
Version: 2.5
       uid  resource                     held              maxheld              barrier                limit              failcnt
    43120:  kmemsize                 51483085             54714368  9223372036854775807  9223372036854775807                    0
            lockedpages                     0                    0                  256                  256                    0
            privvmpages                156446               413948  9223372036854775807  9223372036854775807                    0
            shmpages                    17174                18182  9223372036854775807  9223372036854775807                    0
            dummy                           0                    0  9223372036854775807  9223372036854775807                    0
            numproc                        60                  132                  480                  480                    0
            physpages                  263585               274847                    0               524288                    0
            vmguarpages                     0                    0  9223372036854775807  9223372036854775807                    0
            oomguarpages                15701                24817                26112  9223372036854775807                    0
            numtcpsock                     17                  161                  360                  360                    0
            numflock                       30                   73                  188                  206                    0
            numpty                          3                   12                   12                   12                    2
            numsiginfo                      0                   30                  192                  192                    0
            tcpsndbuf                  222624              1737856              1720320              2703360            127242887
            tcprcvbuf                  212992              1211696              1720320              2703360                    0
            othersockbuf               228888               768328              1126080              2097152                    0
            dgramrcvbuf                     0                19320               262144               262144                    0
            numothersock                  129                  360                  360                  360                   68
            dcachesize               44554051             45815590  9223372036854775807  9223372036854775807                    0
            numfile                      1098                 2485                 9312                 9312                    0
            dummy                           0                    0  9223372036854775807  9223372036854775807                    0
            dummy                           0                    0  9223372036854775807  9223372036854775807                    0
            dummy                           0                    0  9223372036854775807  9223372036854775807                    0
            numiptent                      24                   24                  256                  256                    0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;tcpsndbufã®failcntãŒ127242887ã¨ãªã£ã¦ãŠã‚Šã€TCPã®é€ä¿¡ãƒãƒƒãƒ•ã‚¡ã®ã‚µã‚¤ã‚ºåˆ¶é™ã«å¼•ã£ã‹ã‹ã£ã¦ã„ã¾ã—ãŸã€‚
tcpsndbufã®limitã¯2703360byte = ç´„2MBã§ã€é€šå¸¸ã®ä½¿ç”¨ç¯„å›²ã§ã‚‚ã™ãã«åˆ¶é™ã«å¼•ã£ã‹ã‹ã‚‹ã‚ˆã†ãªè¨­å®šã§ã—ãŸã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;resource                     held              maxheld              barrier                limit              failcnt
tcpsndbuf                  222624              1737856              1720320              2703360            127242887
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è‡ªåˆ†ã®ä»¥å¤–ã«ã‚‚&lt;a href=&#34;http://causeless.hatenablog.jp/entry/2015/06/21/205731&#34;&gt;åŒæ§˜ã®ãƒˆãƒ©ãƒ–ãƒ«ã«æ‚©ã‚“ã§ã„ã‚‹äºº&lt;/a&gt;ã‚’ç™ºè¦‹ã—ã€ä¹—ã‚Šæ›ãˆã‚‹ã“ã¨ã‚’æ±ºæ„ã—ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;h1 id=&#34;å¼•ã£è¶Šã—æ‰‹é †&#34;&gt;å¼•ã£è¶Šã—æ‰‹é †&lt;/h1&gt;

&lt;h2 id=&#34;ãƒ–ãƒ­ã‚°ã®å¼•ã£è¶Šã—&#34;&gt;ãƒ–ãƒ­ã‚°ã®å¼•ã£è¶Šã—&lt;/h2&gt;

&lt;p&gt;ãƒ–ãƒ­ã‚°ã®å¼•ã£è¶Šã—ã¯ç‰¹ã«ãƒˆãƒ©ãƒ–ãƒ«ã‚‚ãªãå®Œäº†ã—ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;DTIã‹ã‚‰ãŠåå‰.comã«ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ç§»ç®¡

&lt;ul&gt;
&lt;li&gt;ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ç§»ç®¡ã¯ã‹ãªã‚Šå‰ï¼ˆä»Šå¹´ã®3æœˆï¼‰ã«è¡Œã„ã¾ã—ãŸ&lt;/li&gt;
&lt;li&gt;DTIã®ã‚µãƒ¼ãƒ“ã‚¹(UbicName)ã§ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’å–å¾—ã—ã¾ã—ãŸãŒã€Aãƒ¬ã‚³ãƒ¼ãƒ‰ã«DTIã§å¥‘ç´„ä¸­ã®ã‚µãƒ¼ãƒã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã—ã‹é¸æŠã§ããªã„ã‚ã‚Šãˆãªã„ä»•æ§˜ã§ã—ãŸâ€¦ğŸ’¢&lt;/li&gt;
&lt;li&gt;å½“ç„¶ãªãŒã‚‰ã€ãŠåå‰.comã§ã¯è‡ªç”±ã«Aãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’è¨­å®šã§ãã¾ã™&lt;/li&gt;
&lt;li&gt;ãŠåå‰.comã¸ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ç§»ç®¡ã¯ã€DTIã®ç®¡ç†ç”»é¢ã‹ã‚‰ç”³è«‹ã§ãã¾ã—ãŸ&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://twitter.com/gam0022/status/837548594320179200&#34;&gt;ç”³è«‹ã‹ã‚‰24æ™‚é–“ãã‚‰ã„ã§ç§»ç®¡ãŒå®Œäº†&lt;/a&gt;ã—ã€ãŠåå‰.comã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç™ºè¡Œã—ã¦ã‚‚ã‚‰ãˆã¾ã—ãŸ&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;æ–°ã‚µãƒ¼ãƒ(ConoHa)ã®å¥‘ç´„

&lt;ul&gt;
&lt;li&gt;æœˆé¡900å††ã®ãƒ¡ãƒ¢ãƒª1GBã®ãƒ—ãƒ©ãƒ³ã‚’é¸æŠã—ã¾ã—ãŸ&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Webã‚µãƒ¼ãƒã®è¨­å®š

&lt;ul&gt;
&lt;li&gt;æ—§ã‚µãƒ¼ãƒ(ServersMan)ã§ã¯åˆæœŸã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®apacheã‚’ãã®ã¾ã¾ä½¿ã£ã¦ã„ã¾ã—ãŸ&lt;/li&gt;
&lt;li&gt;æ–°ã‚µãƒ¼ãƒã§ã¯å­¦ç¿’ç›®çš„ã§nginxã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦è¨­å®šã—ã¾ã—ãŸ&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;æ–°ã‚µãƒ¼ãƒã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤

&lt;ul&gt;
&lt;li&gt;é™çš„CMSã®Hugoã§ã‚µã‚¤ãƒˆæ§‹ç¯‰ã—ã¦ã„ã‚‹ã®ã§ã€é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’rsyncã§ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã ã‘ã§ã—ãŸ&lt;/li&gt;
&lt;li&gt;å…¨ãè‹¦åŠ´ãªãã§ãã¾ã—ãŸ&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;ãƒ‰ãƒ¡ã‚¤ãƒ³ã®Aãƒ¬ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´

&lt;ul&gt;
&lt;li&gt;æ—§ã‚µãƒ¼ãƒã‹ã‚‰æ–°ã‚µãƒ¼ãƒã«ãƒ‰ãƒ¡ã‚¤ãƒ³ã®å‰²å½“ã‚’å¤‰æ›´ã—ã¾ã—ãŸ&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;ãã®ä»–ã®å¼•ã£è¶Šã—&#34;&gt;ãã®ä»–ã®å¼•ã£è¶Šã—&lt;/h2&gt;

&lt;p&gt;ãƒ–ãƒ­ã‚°ã®ä»–ã«ã‚‚ã€éå»ã«ä½œã£ãŸ&lt;a href=&#34;https://gam0022.net/app/tmg/&#34;&gt;Rubyè£½ã®Webã‚¢ãƒ—ãƒª&lt;/a&gt;ã‚„&lt;a href=&#34;https://twitter.com/daigoroubot&#34;&gt;Rubyè£½ã®Twitterã®Bot&lt;/a&gt;ãªã©ã‚‚å¼•ã£è¶Šã—ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;æ–°ã‚µãƒ¼ãƒã§æ—§ã‚µãƒ¼ãƒï¼ˆ6å¹´å‰ï¼‰ã®ç’°å¢ƒã‚’å†ç¾ã—ã‚ˆã†ã¨ã—ãŸã‚‚ã®ã®ã€æ—§ã‚µãƒ¼ãƒã®Rubyã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤ã™ãã¦ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£çš„ã«å±é™ºãªã®ã«åŠ ãˆã¦ã€Cæ‹¡å¼µã®gemã®ãƒ“ãƒ«ãƒ‰ãŒå¤±æ•—ã—ãŸã‚Šã—ã¦ã€æ–­å¿µã—ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;æœ€çµ‚çš„ã«ã¯Rubyã¨ä¾å­˜gemã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æœ€æ–°ç‰ˆã«ä¸Šã’ã¦ã€ã‚³ãƒ¼ãƒ‰ã‚‚ä¿®æ­£ã‚’ã—ã¦ã€ãªã‚“ã¨ã‹æ–°ã‚µãƒ¼ãƒã§å‹•ã‹ã›ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚
ã¾ãŸnginxã§CGIã‚’ä½¿ã†ã«ã¯&lt;a href=&#34;https://qiita.com/gam0022/items/d16cc83a32c5c2efdefc&#34;&gt;FCGI Wrapã®è¨­å®š&lt;/a&gt;ãŒå¿…è¦ã§ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;ã¤ã„ã§ã«Gemfileã‚’æ›¸ã„ã¦ã€ä¾å­˜gemã‚’ç®¡ç†ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;h1 id=&#34;ã¾ã¨ã‚-è‡ªæˆ’&#34;&gt;ã¾ã¨ã‚ï¼ˆè‡ªæˆ’ï¼‰&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;ã‚µãƒ¼ãƒé¸ã³ã§ã¯ã€å€¤æ®µã‚„ã‚¹ãƒšãƒƒã‚¯ã ã‘ã§ã¯ãªãã€TCPã®ãƒãƒƒãƒ•ã‚¡åˆ¶é™ãªã©ã‚‚æ³¨æ„ã—ã¾ã—ã‚‡ã†&lt;/li&gt;
&lt;li&gt;å¥½ããªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã‚µãƒ¼ãƒã‚’ä¹—ã‚Šæ›ãˆã§ãã‚‹ã‚ˆã†ã«ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã¯æœ€åˆã‹ã‚‰ãŠåå‰.comã§å–å¾—ã—ã¦ãŠãã¾ã—ã‚‡ã†

&lt;ul&gt;
&lt;li&gt;6å¹´å‰ã®è‡ªåˆ†ã«ã¯ãã®çŸ¥è­˜ãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸ&amp;hellip;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;é™çš„CMSã¯å¼•ã£è¶Šã—ãŒç°¡å˜ãªã®ã§ã‚ªã‚¹ã‚¹ãƒ¡ã§ã™&lt;/li&gt;
&lt;/ul&gt;</description>
    </item>
    
    <item>
      <title>ServersMan@VPSã§Rubyã®CGIã‚’å®Ÿè¡Œã™ã‚‹ã¾ã§ã®ãƒ¡ãƒ¢</title>
      <link>https://gam0022.net/blog/2012/07/26/run-ruby-cgi-on-serversman-at-vps/</link>
      <pubDate>Thu, 26 Jul 2012 00:11:00 +0900</pubDate>
      
      <guid>https://gam0022.net/blog/2012/07/26/run-ruby-cgi-on-serversman-at-vps/</guid>
      <description>

&lt;p&gt;ServersMan@VPS(Ubuntu)ã§Rubyã®CGIã‚’å®Ÿè¡Œã™ã‚‹ã¾ã§ã®ãƒ¡ãƒ¢ã§ã™ã€‚&lt;/p&gt;

&lt;h2 id=&#34;apache2ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹&#34;&gt;apache2ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹&lt;/h2&gt;

&lt;p&gt;apt-getã‹aptitudeã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚Œã°ã„ã„ã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;sudo aptitude install apache2	
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;addhandlerã‚’è¨­å®šã™ã‚‹&#34;&gt;AddHandlerã‚’è¨­å®šã™ã‚‹&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;/etc/apache2/mods-enabled/mime.conf&lt;/code&gt;ã«AddHandlerã‚’è¨­å®šã—ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;#AddHandler cgi-script .cgi&lt;/code&gt;ã¨ã„ã†è¡ŒãŒã‚ã‚‹ã®ã§ã€
è¦‹ã¤ã‘ã¦ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’è§£é™¤ã—ã¦ã€æ¬¡ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã‚Œã°ã„ã„ã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;AddHandler cgi-script .cgi .rb
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;options-execcgiã‚’è¨­å®šã™ã‚‹&#34;&gt;Options +ExecCGIã‚’è¨­å®šã™ã‚‹&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;/etc/apache2/sites-available/default&lt;/code&gt;ã§Options +ExecCGIã‚’è¨­å®šã—ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;Directory /var/www/html/&amp;gt;
	#Options Indexes FollowSymLinks MultiViews 
	Options Indexes FollowSymLinks MultiViews ExecCGI
	AllowOverride None
	Order allow,deny
	allow from all
&amp;lt;/Directory&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;apache2ã‚’å†èµ·å‹•ã™ã‚‹&#34;&gt;apache2ã‚’å†èµ·å‹•ã™ã‚‹&lt;/h2&gt;

&lt;p&gt;ä¸Šã®2ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ãŸã‚‰ã€apacheã‚’å†èµ·å‹•ã—ã¦è¨­å®šã‚’åæ˜ ã•ã›ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;sudo /etc/init.d/apache2 restart	
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;ruby-cgiã®ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’755ã«ã™ã‚‹&#34;&gt;Ruby CGIã®ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’755ã«ã™ã‚‹&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;cd /var/www/html
chmod 755 test.rb
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã“ã‚Œã§ãŸã¶ã‚“å‹•ãã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ã­ï¼Ÿç°¡å˜ã§ã—ã‚‡ï¼Ÿ&lt;/p&gt;

&lt;h2 id=&#34;ã†ã¾ãã„ã‹ãªã„ã¨ãã¯&#34;&gt;ã†ã¾ãã„ã‹ãªã„ã¨ãã¯&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;/var/log/apache2/error.log&lt;/code&gt;ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¦‹ã¾ã—ã‚‡ã†ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Rsyncã‚’ä½¿ã£ã¦Octopressã‚’VPSä¸Šã§å…¬é–‹ã™ã‚‹</title>
      <link>https://gam0022.net/blog/2012/07/23/run-octopress-on-a-vps-using-rsync/</link>
      <pubDate>Mon, 23 Jul 2012 10:02:00 +0900</pubDate>
      
      <guid>https://gam0022.net/blog/2012/07/23/run-octopress-on-a-vps-using-rsync/</guid>
      <description>

&lt;p&gt;ä»Šå›ã‚‚Octopressã«é–¢ã™ã‚‹è¨˜äº‹ã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;å…ˆæ—¥ã€Octopressã‚’ä½¿ã£ã¦GithubPagesä¸Šã«ãƒ–ãƒ­ã‚°ã‚’é‹å–¶ã—ã¾ã—ãŸãŒã€
æ°—ãŒå¤‰ã‚ã£ã¦ãƒ¬ãƒ³ã‚¿ãƒ«ã—ã¦ã„ã‚‹VPSä¸Šã§é‹å–¶ã—ãŸããªã‚Šã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;Octopressã§ã¯&lt;code&gt;rake deploy&lt;/code&gt;ã‚’å©ãã ã‘ã§Rsyncã‚’ä½¿ã„è‡ªåˆ†ã®ã‚µãƒ¼ãƒä¸Šã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’åŒæœŸã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã®ã§ã€
ãã®æ–¹æ³•ã‚’ç´¹ä»‹ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;Rsyncã‚’ä½¿ã£ã¦åŒæœŸã™ã‚‹ãŸã‚ã«ã¯æ¬¡ã®2ã¤ã®ä½œæ¥­ã‚’ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;å…¬é–‹éµèªè¨¼ã‚’ä½¿ã£ã¦sshã§ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚&lt;/li&gt;
&lt;li&gt;ã‚µãƒ¼ãƒå´ã®&lt;code&gt;~/.ssh/authorized_keys&lt;/code&gt;ã«ãƒ­ãƒ¼ã‚«ãƒ«å´ã®å…¬é–‹éµã‚’ç™»éŒ²ã™ã‚‹ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ã“ã“ã§ã¯ã€serverã¨ã„ã†åå‰ã®ã‚µãƒ¼ãƒã«ä½œæˆæ¸ˆã¿ã®userã¨ã„ã†ãƒ¦ãƒ¼ã‚¶ã‚’ä½¿ã£ã¦ã€å…¬é–‹éµã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã¾ã§ã®æ‰‹é †ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;h1 id=&#34;ãƒ­ãƒ¼ã‚«ãƒ«å´ã®è¨­å®š-éµã®ãƒšã‚¢ã®ç”Ÿæˆ&#34;&gt;ãƒ­ãƒ¼ã‚«ãƒ«å´ã®è¨­å®š(éµã®ãƒšã‚¢ã®ç”Ÿæˆ)&lt;/h1&gt;

&lt;p&gt;ã¾ãšã€ãƒ­ãƒ¼ã‚«ãƒ«å´ã§éµã®ãƒšã‚¢ã®ç”Ÿæˆã—ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;cd ~/.ssh
ssh-keygen -t rsa # RSAã®éµã®ãƒšã‚¢ã‚’ç”Ÿæˆã™ã‚‹ã€‚save the keyã¯ç©ºç™½ã§OKã€‚ãƒ‘ã‚¹ãƒ•ãƒ¬ãƒ¼ã‚ºã¯ä»»æ„ã®ã‚‚ã®ã‚’æŒ‡å®šã™ã‚‹ã€‚
cat id_rsa.pub # å…¬é–‹éµã¯ã‚µãƒ¼ãƒã®authorized_keysã«å¾Œã§ç™»éŒ²ã™ã‚‹ã®ã§è¡¨ç¤ºã—ã¦ãŠã
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;ã‚µãƒ¼ãƒå´ã®è¨­å®š&#34;&gt;ã‚µãƒ¼ãƒå´ã®è¨­å®š&lt;/h1&gt;

&lt;h2 id=&#34;å…¬é–‹éµã®ç™»éŒ²&#34;&gt;å…¬é–‹éµã®ç™»éŒ²&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;vim ~/.ssh/authorized_keys # ä¸Šã§è¡¨ç¤ºã—ãŸãƒ­ãƒ¼ã‚«ãƒ«å´ã®id_rsa.pubã‚’æœ€å¾Œã®è¡Œã«è¿½åŠ ã™ã‚‹ã€‚(ãƒ•ã‚¡ã‚¤ãƒ«ãŒãªã‘ã‚Œã°ä½œã‚‹)
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;sshã®è¨­å®š&#34;&gt;sshã®è¨­å®š&lt;/h2&gt;

&lt;p&gt;vimãªã©ã§ã€ã‚µãƒ¼ãƒå´ã®&lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt;ã‚’ç·¨é›†ã—ã¾ã™ã€‚
é–“é•ã£ãŸè¨­å®šã‚’ã™ã‚‹ã¨æœ€æ‚ªsshã§ãƒ­ã‚°ã‚¤ãƒ³ã§ããªã‚‹ã®ã§æ³¨æ„ã—ã¾ã—ã‚‡ã†w&lt;/p&gt;

&lt;p&gt;ç§ã®å ´åˆã¯ã“ã®ã‚ˆã†ãªæ„Ÿã˜ã«&lt;strong&gt;ä¸€éƒ¨ã‚’æ›¸ãæ›ãˆã¾ã—ãŸã€‚&lt;/strong&gt;
ã“ã®è¨˜äº‹ã‚’æ›¸ã„ã¦ã„ã‚‹ç§ã§ã™ãŒã€ã‚µãƒ¼ãƒã®è¨­å®šã¯åˆå¿ƒè€…ãªã®ã§ã€ã‚ã¾ã‚Šä¿¡ç”¨ã—ãªã„ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†w
ã‚ãã¾ã§å‚è€ƒç¨‹åº¦ã§ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;AllowUsers user
RSAAuthentication yes 
PubkeyAuthentication yes 
AuthorizedKeysFile   %h/.ssh/authorized_keys
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;VPSä¸Šã®è¨­å®šãŒçµ‚ã‚ã£ãŸã‚‰ã€sshdã‚’å†èµ·å‹•ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;/etc/init.d/ssh restart
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;å†ã³ãƒ­ãƒ¼ã‚«ãƒ«å´ã®è¨­å®š-sshã®ãƒ†ã‚¹ãƒˆ&#34;&gt;å†ã³ãƒ­ãƒ¼ã‚«ãƒ«å´ã®è¨­å®š(sshã®ãƒ†ã‚¹ãƒˆ)&lt;/h1&gt;

&lt;p&gt;ä»¥ä¸Šã§å…¬é–‹éµã‚’ä½¿ã£ã¦sshã‚’ã™ã‚‹æº–å‚™ãŒæ•´ã£ãŸã®ã§ã€ãƒ†ã‚¹ãƒˆã—ã¦ã¿ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;cd ~/.ssh
chmod 600 id_rsa # ãƒ‘ãƒ¼ãƒŸã‚·ãƒ§ãƒ³ãŒ600ã§ãªã„ã¨ã€ŒWARNING: UNPROTECTED PRIVATE KEY FILE!ã€ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚
ssh -i id_rsa user@server #ã“ã‚Œã§ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚Œã°æˆåŠŸã€‚-iã§ç§˜å¯†éµã‚’æŒ‡å®šã§ãã‚‹ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;octopressã®è¨­å®š&#34;&gt;Octopressã®è¨­å®š&lt;/h1&gt;

&lt;p&gt;ã“ã“ã¾ã§æ¥ã‚Œã°ã€ã‚ã¨ã¯Octopressã®è¨­å®šã ã‘ã§ã™ã€‚&lt;code&gt;Rakefile&lt;/code&gt;ã‚’ç·¨é›†ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;ç§ã®å ´åˆã€GithubPagesç”¨ã«RakeFileã‚’è¨­å®šã—ã¦ã—ã¾ã£ãŸã®ã§ã€æ›¸ãç›´ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;## -- Rsync Deploy config -- ##
# Be sure your public key is listed in your server&#39;s ~/.ssh/authorized_keys file
ssh_user       = &amp;quot;user@server&amp;quot;
ssh_port       = &amp;quot;1234&amp;quot; #æ™®é€šã¯22ã§ã™ãŒã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ç†ç”±ã§(
document_root  = &amp;quot;/var/www/html/&amp;quot; #htmlã®å…¬é–‹ç”¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã€‚ServersMan@VPSãªã‚‰ã“ã®è¨­å®šã§ã„ã„ã¯ãšã€‚
rsync_delete   = true
#deploy_default = &amp;quot;push&amp;quot;
deploy_default = &amp;quot;rsync&amp;quot; #rsyncã§åŒæœŸã—ã¾ã™ã€‚
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ã“ã‚Œã§è¨­å®šã¯çµ‚ã‚ã‚Šã§ã™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;code&gt;rake deploy&lt;/code&gt;ã§ãƒ•ã‚¡ã‚¤ãƒ«ãŒåŒæœŸã§ããŸã‚‰æˆåŠŸã§ã™ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;å‚è€ƒè¨˜äº‹
:&lt;a href=&#34;http://octopress.org/docs/deploying/rsync/&#34;&gt;Deploying With Rsync&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
